{"version":3,"sources":["HomeSetApplyForDailiView.js"],"names":["socket","require","cc","Class","extends","Component","properties","contentView","Node","nameEditBox","EditBox","idLabel","Label","phoneEditBox","yanzhengmaEditBox","yzmAlertText","maxCount","dailiIntroView","onLoad","isRunning","currentCountNum","ID","ttqp_global","currentUserInfo","roleId","toString","count","length","i","string","onfire","on","onGetVerCode","bind","onApplyAgentRequest","onShowView","isShow","callback","setScale","scaleAmin1","scaleTo","scaleAmin2","runAction","sequence","scaleAmin","node","active","onCloseVerCodeTimer","timer","unschedule","onVerCodeRequest","phone","console","log","params","scn","send","onCommitRequest","name","code","data","schedule","onMenusBtnClick","event","customData","itemIdx","parseInt","getComponent","onCloseBtnClick"],"mappings":"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","file":"HomeSetApplyForDailiView.js","sourceRoot":"../../../../../../assets/Script/HomeScript/HomeSettingView","sourcesContent":["// 发接口对象\nvar socket = require(\"websocketScript\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        contentView: cc.Node,\n\n        /// 姓名输入框\n        nameEditBox: cc.EditBox,\n        /// 游戏ID标签\n        idLabel: cc.Label,\n        /// 手机号输入框\n        phoneEditBox: cc.EditBox,\n        /// 验证码输入框\n        yanzhengmaEditBox: cc.EditBox,\n\n        /// 验证码的提示标签\n        yzmAlertText: cc.Label,\n        /// 倒计时的最大数\n        maxCount: 60,\n\n        // 子级弹窗\n        dailiIntroView: cc.Node,\n\n    },\n\n    onLoad() {\n        // 是否在倒计时\n        this.isRunning = false;\n        // 当前倒计时的数字\n        this.currentCountNum = this.maxCount;\n\n        let ID = ttqp_global.currentUserInfo.roleId.toString();\n        var count = 6 - ID.length;\n        for (let i = 0; i < count; i++) {\n            ID = \"0\" + ID;\n        }\n        this.idLabel.string = ID;\n        this.nameEditBox.string = \"\";\n        this.phoneEditBox.string = \"\";\n        this.yanzhengmaEditBox.string = \"\";\n\n        // 获取验证码 接口回调 配置\n        onfire.on(\"ProjectGetVerCodeHandle\", this.onGetVerCode.bind(this));\n        onfire.on(\"HomeApplyAgentHandle\", this.onApplyAgentRequest.bind(this));\n        \n    },\n\n    /**\n     * 弹出/关闭 窗口\n     * @param {是否弹出} isShow       \n     * @param {回调函数，在点击使用的时候回调} callback \n     */\n    onShowView(isShow, callback) {\n        this.callback = callback;\n        this.contentView.setScale(0.8, 0.8);\n\n        if (isShow) {\n            var scaleAmin1 = cc.scaleTo(0.000001, 0.8, 0.8);\n            var scaleAmin2 = cc.scaleTo(0.2, 1, 1);\n            this.contentView.runAction(cc.sequence(scaleAmin1, scaleAmin2));\n        } else {\n            var scaleAmin = cc.scaleTo(0, 0.8, 0.8);\n            this.contentView.runAction(scaleAmin);\n        }\n        this.node.active = isShow;\n    },\n\n    /**\n     * 关闭获取验证码的倒计时\n     */\n    onCloseVerCodeTimer() {\n        this.isRunning = false;\n        this.yzmAlertText.string = \"获取验证码\";\n        this.currentCountNum = this.maxCount;\n        if (this.timer) {\n            this.unschedule(this.timer);\n        }\n    },\n\n    /*********************** 发送接口 ***********************/\n    onVerCodeRequest() {\n        let phone = this.phoneEditBox.string ? this.phoneEditBox.string : \"\";\n        if (phone.length == 0) {\n            console.log(\"请输入手机号码！\");\n        } else if (phone.length != 11) {\n            console.log(\"请输入正确的手机号码！\");\n        } else {\n            let params = {\n                \"phone\": phone,\n                \"type\": 1\n            };\n            cc.scn.socket.send(10905, params);\n        }\n    },\n\n    /**\n     * 提交申请\n     */\n    onCommitRequest() {\n        let name = this.nameEditBox.string ? this.nameEditBox.string : \"\";\n        let ID = this.idLabel.string;\n        let phone = this.phoneEditBox.string ? this.phoneEditBox.string : \"\";\n        let code = this.yanzhengmaEditBox.string ? this.yanzhengmaEditBox.string : \"\";\n        if (!(name.length >=2 && name.length <=4)) {\n            console.log(\"请输入正确的姓名\");\n        } else if (phone.length != 11) {\n            console.log(\"请输入正确的手机号码\");\n        } else if (code.length != 6) {\n            console.log(\"请输入正确的验证码\");\n        } else {\n            let params = {\n                \"ID\": ID,\n                \"name\": name,\n                \"phone\": phone,\n                \"code\": code,\n            };\n            cc.scn.socket.send(10903, params);\n        }\n    },\n\n    /*********************** 接口回调 ***********************/\n    /**\n     * 获取验证码接口\n     */\n    onGetVerCode(data) {\n        if (this.node.active == false) return;\n        \n        this.isRunning = true;\n        this.yzmAlertText.string = this.currentCountNum + \"s\";\n\n        this.timer = function () {\n            if (this.currentCountNum > 0) {\n                this.currentCountNum--;\n                this.yzmAlertText.string = this.currentCountNum + \"s\";\n            } else {\n                // 关闭获取验证码的定时器\n                this.onCloseVerCodeTimer();\n            }\n        }\n        this.schedule(this.timer, 1)\n    },\n\n    /**\n     * 提交申请代理\n     */\n    onApplyAgentRequest(data) {\n        //\n        console.log(data);\n\n        // 关掉窗口\n        this.onShowView(false, this.callback);\n        // 关闭获取验证码的定时器\n        this.onCloseVerCodeTimer();\n        if (this.callback) {\n            this.callback();\n        }\n    },\n\n    /**\n     * 功能按钮点击事件\n     */\n    onMenusBtnClick(event, customData) {\n        let itemIdx = parseInt(customData);\n        switch (itemIdx) {\n            case 0: {   // 确定\n                // 提交申请\n                this.onCommitRequest();\n            }\n                break;\n            case 1: {   // 取消\n                this.onShowView(false, this.callback);\n                // 关闭获取验证码的定时器\n                this.onCloseVerCodeTimer();\n            }\n                break;\n            case 2: {   // 获取验证码\n                if (!this.isRunning) {\n                    // 发送获取验证码接口\n                    this.onVerCodeRequest();\n                }\n            }\n                break;\n            case 3: {   // 代理说明\n                this.dailiIntroView.getComponent('HomeSetDailiIntroView').onShowView(true, () => {\n                    //\n                });\n            }\n                break;\n\n            default:\n                break;\n        }\n    },\n\n    /**\n     * 点击关闭按钮\n     */\n    onCloseBtnClick(event) {\n        // 关闭获取验证码的定时器\n        this.onCloseVerCodeTimer();\n        this.onShowView(false, this.callback);\n    },\n});\n"]}