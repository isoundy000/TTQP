{"version":3,"sources":["HomeActivityPanView.js"],"names":["shopItems","require","turnList","global_config_data","cc","Class","extends","Component","properties","itemIcons","Node","itemBgViews","startBtn","goldLabel","Label","zuanLabel","freeAlertNode","singleCountZuanNode","singleCountZuanLabel","tenCountZuanAlertLabel","fetchView","onLoad","isRunning","free","isTenLianZhuan","onRequestHandleConfig","onConfigDataSource","onConfigUI","angles","angleIdx","onfire","on","updateGoldAtMessage","bind","updateDiamondAtMessage","rotaryTableHandle","getChoujiangHandle","getFreeCount","onShowView","isShow","node","active","onRotaryTableRequest","scn","socket","send","onChoujiangRequest","type","parseInt","zhuanpanData","data","err_code","console","log","freeCount","toString","idArray","resultList","onRunningAmin","obj","ttqp_global","currentUserInfo","gold","string","diamond","zuan","single","ten","onSingleRotateFinish","onConfigItemBgView","setTimeout","self","getComponent","onGetFetchShopItems","actionDefault","rotateTo","runAction","onTenLianZhuanFinish","isZero","isOne","isTwo","isThree","isFour","isFive","onStartBtnClick","event","onShiLianZhuanBtnClick","length","i","shops","shopData","id","getCount","push","shopID","j","shopItem","count","k","date","actionBy0","rotateBy","actionBy1","actionBy2","actionBy3","actionBy4","actionBy5","actionBy6","actionBy7","actionBy8","seq","sequence","shopList","turns","turnData","itemData","mid","shop","value"],"mappings":"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","file":"HomeActivityPanView.js","sourceRoot":"../../../../../../assets/Script/HomeScript/HomeActivityShowView","sourcesContent":["// 所涉及到的本地配置数据文件\nlet shopItems = require('Item');    // 商品列表\nlet turnList = require('TurnTable');// 转盘中的商品配置列表\nlet global_config_data = require('HallGameValue')   // 全局基本配置文件\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // 转盘上商品的图标节点数组\n        itemIcons: [cc.Node],\n        // 转盘上商品的图标背景节点数组\n        itemBgViews: [cc.Node],\n\n        // 开始抽奖按钮\n        startBtn: cc.Node,\n        // 金币数标签\n        goldLabel: cc.Label,\n        // 钻石数\n        zuanLabel: cc.Label,\n        // 免费次数提醒标签\n        freeAlertNode: cc.Node,\n        // 单次抽奖所需钻石数量标签背景\n        singleCountZuanNode: cc.Node,\n        // 单次抽奖所需钻石数量标签\n        singleCountZuanLabel: cc.Label,\n        // 十连抽标签\n        tenCountZuanAlertLabel: cc.Label,\n\n        // 抽奖成功后，弹出确认领取弹窗\n        fetchView: cc.Node,\n    },\n\n    onLoad() {\n        this.isRunning = false;\n        // 免费次数，默认为0\n        this.free = \"0\";\n        this.isTenLianZhuan = false;\n\n        // 配置弹窗接口\n        this.onRequestHandleConfig();\n\n        // 配置本地数据\n        this.onConfigDataSource();\n        // 配置UI\n        this.onConfigUI();\n\n        this.angles = [360, 62, 125, 180, 240, 299];\n        this.angleIdx = 0;\n\n        // 监听金币和钻石变化\n        onfire.on(\"updateGoldAtMessage\",this.updateGoldAtMessage.bind(this));\n        onfire.on(\"updateDiamondAtMessage\",this.updateDiamondAtMessage.bind(this));\n    },\n\n    /**\n     * 配置弹窗接口\n     */\n    onRequestHandleConfig() {\n        onfire.on(\"HomeRotaryTableHandle\", this.rotaryTableHandle.bind(this));\n        onfire.on(\"HomeChoujiangHanle\", this.getChoujiangHandle.bind(this));\n        onfire.on(\"HomeGetFreeCountHandle\", this.getFreeCount.bind(this));\n    },\n\n    /**\n     * @param {是否显示转盘} isShow \n     */\n    onShowView(isShow) {\n        this.node.active = isShow;\n        if (isShow) {\n            this.onRotaryTableRequest();\n        }\n    },\n\n    /****************************************  本类接口相关  ****************************************/\n    // 获取签到数据\n    onRotaryTableRequest() {\n        cc.scn.socket.send(10801);\n    },\n    // 抽奖接口\n    onChoujiangRequest() {\n        let type = 1;\n        if (this.isTenLianZhuan) {\n            type = 2;\n        } else {\n            type = parseInt(this.zhuanpanData.free) > 0 ? 3 : 1;\n        }\n\n        cc.scn.socket.send(10802, {\n            \"type\": type\n        });\n    },\n\n    /****************************************  本类接口回调相关  ****************************************/\n    // 触发抽奖接口的奠基接口\n    rotaryTableHandle(data) {\n    },\n    // 抽奖接口回调，先请求成功后，才能进行抽奖\n    getChoujiangHandle(data) {\n        if (data.err_code) {\n            console.log(\"这里抽奖失败了都！！！\");\n            this.isRunning = false;\n            return;\n        }\n\n        // 处理免费抽奖次数\n        let freeCount = parseInt(this.zhuanpanData.free);\n        if (!this.isTenLianZhuan && freeCount > 0) {\n            this.zhuanpanData.free = (freeCount - 1).toString();\n            this.free = this.zhuanpanData.free;\n            this.freeAlertNode.active = (freeCount - 1) > \"0\";\n            this.singleCountZuanNode.active = !this.freeAlertNode.active;\n        }\n\n        this.idArray = data.resultList;\n\n        this.onRunningAmin();\n    },\n\n    // 返回免费次数接口\n    getFreeCount(data) {\n        if (!this.node.active) return;\n        console.log(\"getFreeCount === \" + data.free);\n        this.free = data.free.toString();\n        this.zhuanpanData.free = this.free;\n        this.freeAlertNode.active = parseInt(this.zhuanpanData.free) > \"0\";\n        this.singleCountZuanNode.active = !this.freeAlertNode.active;\n    },\n\n    /**\n     * 服务器主推金币变化接口回调\n     */\n    updateGoldAtMessage: function(obj) { \n        ttqp_global.currentUserInfo.gold = obj.gold.toString();\n        this.zhuanpanData.gold = ttqp_global.currentUserInfo.gold;\n        this.goldLabel.string = this.zhuanpanData.gold;\n    },\n\n    /**\n     * 服务器主推钻石变化接口回调\n     */\n    updateDiamondAtMessage: function(obj) {\n        ttqp_global.currentUserInfo.diamond = obj.diamond.toString();\n        this.zhuanpanData.zuan = ttqp_global.currentUserInfo.diamond;\n        this.zuanLabel.string = this.zhuanpanData.zuan;\n    },\n\n    // 获取转盘本地数据\n    onConfigUI() {\n        this.zuanLabel.string = this.zhuanpanData.zuan;\n        this.goldLabel.string = this.zhuanpanData.gold;\n        this.singleCountZuanLabel.string = this.zhuanpanData.single;\n        this.tenCountZuanAlertLabel.string = this.zhuanpanData.ten;\n        this.freeAlertNode.active = parseInt(this.zhuanpanData.free) > \"0\";\n        this.singleCountZuanNode.active = !this.freeAlertNode.active;\n    },\n\n    /**\n     * 单次循转\n     */\n    onSingleRotateFinish() {\n\n        this.onConfigDataSource();\n\n        if (this.angleIdx == 0) {\n            this.onConfigItemBgView(true, false, false, false, false, false);\n        } else if (this.angleIdx == 1) {\n            this.onConfigItemBgView(false, true, false, false, false, false);\n        } else if (this.angleIdx == 2) {\n            this.onConfigItemBgView(false, false, true, false, false, false);\n        } else if (this.angleIdx == 3) {\n            this.onConfigItemBgView(false, false, false, true, false, false);\n        } else if (this.angleIdx == 4) {\n            this.onConfigItemBgView(false, false, false, false, true, false);\n        } else if (this.angleIdx == 5) {\n            this.onConfigItemBgView(false, false, false, false, false, true);\n        }\n        if (!this.isTenLianZhuan) {\n            setTimeout(() => {\n                let self = this;\n                this.fetchView.getComponent('HomeActivityShopFetchView').onShowView(true, this.onGetFetchShopItems(), () => {\n                    var actionDefault = cc.rotateTo(0, 0);\n                    self.startBtn.runAction(actionDefault);\n                    self.onConfigItemBgView(false, false, false, false, false, false);\n                });\n            }, 1000);\n        }\n    },\n\n    /**\n     * 十连转完成\n     */\n    onTenLianZhuanFinish() {\n        this.onSingleRotateFinish();\n        setTimeout(() => {\n            let self = this;\n            this.fetchView.getComponent('HomeActivityShopFetchView').onShowView(true, this.onGetFetchShopItems(), () => {\n                var actionDefault = cc.rotateTo(0, 0);\n                self.startBtn.runAction(actionDefault);\n                self.onConfigItemBgView(false, false, false, false, false, false);\n            });\n        }, 1000);\n    },\n\n    /**\n     * 转到哪个商品，哪个商品亮起来\n     */\n    onConfigItemBgView(isZero, isOne, isTwo, isThree, isFour, isFive) {\n        this.itemBgViews[0].active = isZero;\n        this.itemBgViews[1].active = isOne;\n        this.itemBgViews[2].active = isTwo;\n        this.itemBgViews[3].active = isThree;\n        this.itemBgViews[4].active = isFour;\n        this.itemBgViews[5].active = isFive;\n    },\n\n    /**\n     * 开始按钮的点击\n     */\n    onStartBtnClick(event) {\n        this.onConfigItemBgView(false, false, false, false, false, false);\n\n        if (this.isRunning == false) {\n            this.isTenLianZhuan = false;\n            this.onChoujiangRequest();\n            this.isRunning = true;\n        }\n    },\n    /**\n     * 十连转按钮的点击\n     */\n    onShiLianZhuanBtnClick(event) {\n        if (this.isRunning == false) {\n            \n            this.isTenLianZhuan = true;\n            this.onChoujiangRequest();\n            this.isRunning = true;\n        }\n    },\n\n    /**\n     * 筛选，排查，统计所有抽中的物品和数量\n     */\n    onGetFetchShopItems() {\n        let shopItems = [];\n        if (this.idArray.length == 1) {\n            for (let i = 0; i < this.zhuanpanData.shops.length; i++) {\n                let shopData = this.zhuanpanData.shops[i];\n                if (shopData.id == this.idArray[0]) {\n                    shopData.getCount = \"1\";\n                    shopItems.push(shopData);\n                    break;\n                }\n            }\n        } else {\n            for (let i = 0; i < this.idArray.length; i++) {\n                const shopID = this.idArray[i];\n\n                for (let j = 0; j < this.zhuanpanData.shops.length; j++) {\n                    let shopItem = this.zhuanpanData.shops[j];\n                    if (shopItem.id == shopID) {\n                        let count = shopItem.getCount ? parseInt(shopItem.getCount) : 0;\n                        this.zhuanpanData.shops[j].getCount = (count + 1).toString();\n                    }\n                }\n            }\n\n            for (let k = 0; k < this.zhuanpanData.shops.length; k++) {\n                let shopItem = this.zhuanpanData.shops[k];\n                if (parseInt(shopItem.getCount) > 0) {\n                    shopItems.push(shopItem);\n                }\n            }\n        }\n        console.log(\"shopItems == \");\n        console.log(shopItems);\n        return shopItems;\n    },\n\n    onRunningAmin() {\n        if (this.isRunning == true) {\n            let date = 0.3;\n            var actionBy0 = cc.rotateBy(date, 360);\n            var actionBy1 = cc.rotateBy(date, 720);\n            var actionBy2 = cc.rotateBy(date, 720);\n            var actionBy3 = cc.rotateBy(date, 720);\n            var actionBy4 = cc.rotateBy(date, 720);\n            var actionBy5 = cc.rotateBy(date, 720);\n            var actionBy6 = cc.rotateBy(date, 720);\n            var actionBy7 = cc.rotateBy(date, 360);\n\n            for (let i = 0; i < this.zhuanpanData.shops.length; i++) {\n                const shopData = this.zhuanpanData.shops[i];\n                if (shopData.id == this.idArray[0]) {\n                    this.angleIdx = i;\n                }\n            }\n            var actionBy8 = cc.rotateBy(date * 2, this.angles[this.angleIdx]);\n            var seq = cc.sequence(actionBy0, actionBy1, actionBy2, actionBy3, actionBy4, actionBy5, actionBy6, actionBy7, actionBy8);\n            this.startBtn.runAction(seq);\n\n            setTimeout(() => {\n                // 判断是10连转还是单转\n                if (this.isTenLianZhuan == true) {\n                    this.onTenLianZhuanFinish();\n                } else {\n                    this.onSingleRotateFinish();\n                }\n                this.isRunning = false;\n            }, date * 10 * 1000);\n        }\n    },\n\n    onConfigDataSource() {\n\n        let shopList = [];\n        let turns = turnList;\n        for (let i = 0; i < turns.length; i++) {\n            let turnData = turns[i];\n            for (let j = 0; j < shopItems.length; j++) {\n                const itemData = shopItems[j];\n                if (parseInt(turnData.mid) == parseInt(itemData.id)) {\n                    turnData.shop = itemData;\n                    break;\n                }\n            }\n            turnData.getCount = \"0\";\n            shopList.push(turnData);\n        }\n\n        this.zhuanpanData = {\n            \"zuan\": ttqp_global.currentUserInfo ? ttqp_global.currentUserInfo.diamond.toString() : \"\",\n            \"gold\": ttqp_global.currentUserInfo ? ttqp_global.currentUserInfo.gold.toString() : \"\",\n            \"free\": this.free,\n            \"single\": global_config_data[1].value.toString(),\n            \"ten\": global_config_data[2].value.toString(),\n            \"shops\": shopList,\n        }\n    },\n});\n"]}