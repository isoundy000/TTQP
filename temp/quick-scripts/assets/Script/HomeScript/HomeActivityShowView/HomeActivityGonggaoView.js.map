{"version":3,"sources":["HomeActivityGonggaoView.js"],"names":["cc","Class","extends","Component","properties","titleScrollView","ScrollView","titleSrollContent","Node","titlePrefab","Prefab","imageNode","detailNode","onLoad","onfire","on","onGetNoticeData","bind","init","removeAllChildren","i","noticeList","length","notice","item","instantiate","tag","addChild","getComponent","onClickTitleItem","onShowView","isShow","node","active","onGetNoticeListRequest","scn","socket","send","data","event","currentTarget","children","onStatus","content","toString","Label","string","picture","self","loader","load","err","texture","Sprite","spriteFrame","SpriteFrame"],"mappings":"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","file":"HomeActivityGonggaoView.js","sourceRoot":"../../../../../../assets/Script/HomeScript/HomeActivityShowView","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        titleScrollView: cc.ScrollView,\n        titleSrollContent: cc.Node,\n        titlePrefab: cc.Prefab,\n\n        imageNode: cc.Node,\n        detailNode: cc.Node,\n    },\n\n    onLoad() {\n\n        // 获取公告列表\n        onfire.on(\"HomeNoticeListHandle\",this.onGetNoticeData.bind(this));\n    },\n\n    init() {\n\n        this.titleSrollContent.removeAllChildren();\n        for (let i = 0; i < this.noticeList.length; i++) {\n            const notice = this.noticeList[i];\n            let item = cc.instantiate(this.titlePrefab);\n            item.tag = i;\n            this.titleSrollContent.addChild(item);\n            item.getComponent('HomeActivityGonggaoTitleBtn').init(notice);\n            item.on('click', this.onClickTitleItem, this);\n        }\n        if (this.noticeList && this.noticeList.length > 0) {\n            this.onClickTitleItem(null);\n        }\n    },\n\n    onShowView(isShow) {\n        this.node.active = isShow;\n        if (isShow) {\n            // 公告列表\n            this.noticeList = [];\n            \n            this.onGetNoticeListRequest();\n        }\n    },\n\n    /****************************************  本类接口相关  ****************************************/\n    onGetNoticeListRequest() {\n        cc.scn.socket.send(10805);\n    },\n    /****************************************  本类接口回调相关  ****************************************/\n    onGetNoticeData(data) {\n        //\n        this.noticeList = data.noticeList;\n        this.init();\n    },\n\n    onClickTitleItem(event) {\n\n        let tag = event ? event.currentTarget.tag : 0;\n\n        for (let i = 0; i < this.titleSrollContent.children.length; i++) {\n            const item = this.titleSrollContent.children[i];\n            item.getComponent('HomeSelectBtn').onStatus(i == tag);\n        }\n\n        let notice = this.noticeList[tag];\n\n        let content = notice.content ? notice.content.toString() : \"\";\n        this.detailNode.active = content.length > 0;\n        this.detailNode.getComponent(cc.Label).string = content;\n\n        let picture = notice.picture ? notice.picture.toString() : \"\";\n        this.imageNode.active = picture.length > 0;\n        if (picture.length) {\n            let self = this;\n            cc.loader.load(picture, function (err, texture) {\n                self.imageNode.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\n            });\n        }\n    },\n});\n"]}