{"version":3,"sources":["../../../../../../assets/Script/HomeScript/HomeRankingListView/assets/Script/HomeScript/HomeRankingListView/HomeRankingAllView.js"],"names":["cc","Class","extends","Component","properties","contentScrollView","ScrollView","scrollContent","Node","rankingItemPrefab","Prefab","onLoad","onfire","on","onGetAllMoneyRankingHandle","bind","scrollViewEventHandler","EventHandler","target","node","component","handler","scroll","getComponent","scrollEvents","push","onCreateItem","rankingList","removeAllChildren","i","itemData","item","instantiate","addChild","self","init","data","idx","callback","length","onShowView","isShow","active","page","onGetRankingListRequest","params","scn","socket","send","rankList","concat","onLoadMoreHandle","scrollview","eventType","EventType","BOUNCE_BOTTOM","BOUNCE_TOP"],"mappings":"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","file":"HomeRankingAllView.js","sourceRoot":"../../../../../../assets/Script/HomeScript/HomeRankingListView","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        contentScrollView: cc.ScrollView,\n        scrollContent: cc.Node,\n\n        rankingItemPrefab: cc.Prefab,\n    },\n\n    onLoad() {\n        onfire.on(\"HomeAllMoneyRankingHanle\",this.onGetAllMoneyRankingHandle.bind(this));\n\n        // 给滑动视图view 添加上拉加载功能操作\n        var scrollViewEventHandler = new cc.Component.EventHandler();\n        scrollViewEventHandler.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\n        scrollViewEventHandler.component = \"HomeRankingAllView\";//这个是代码文件名\n        scrollViewEventHandler.handler = \"onLoadMoreHandle\";// 触发上拉加载回调\n        var scroll = this.contentScrollView.getComponent(cc.ScrollView);\n        scroll.scrollEvents.push(scrollViewEventHandler);\n    },\n\n    onCreateItem(rankingList) {\n\n        this.scrollContent.removeAllChildren();\n        for (let i = 0; i < rankingList.length; i++) {\n            const itemData = rankingList[i];\n            let item = cc.instantiate(this.rankingItemPrefab);\n            this.scrollContent.addChild(item);\n\n            let self = this;\n            item.getComponent('HomeRankingListItem').init(itemData, i, (data, idx) => {\n                self.callback(data);\n            });\n        }\n    },\n\n    /**\n     * \n     * @param {*} isShow 是否显示好友榜单\n     * @param {*} callback 是否显示好友榜单\n     */\n    onShowView(isShow, callback) {\n        this.node.active = isShow;\n        this.callback = callback;\n\n        if (isShow) {\n            this.page = 0;\n            this.rankingList = [];\n            this.onGetRankingListRequest()\n        }\n    },\n\n    /************************  本类发送接口相关  ************************/\n    onGetRankingListRequest() {\n        var params = {\n            \"page\": (this.page ? this.page : 0)\n        };\n        cc.scn.socket.send(11001, params);\n    },\n\n    /************************  本类接口回调相关  ************************/\n    onGetAllMoneyRankingHandle(data) {\n        if (this.node.active == false) return;\n        if (!data || data.rankList.length == 0) return;\n\n        if (this.page == 0) {\n            this.rankingList = data.rankList;\n        } else {\n            this.rankingList = this.rankingList.concat(data.rankList);\n        }\n        this.page += 1;\n        this.onCreateItem(this.rankingList);\n    },\n\n    /**\n     * 滑动视图 ScrollView 的上拉加载\n     */\n    onLoadMoreHandle(scrollview, eventType) {\n        if (eventType === cc.ScrollView.EventType.BOUNCE_BOTTOM) {\n            this.onGetRankingListRequest();\n        } else if (eventType === cc.ScrollView.EventType.BOUNCE_TOP) {\n            this.page = 0;\n            this.onGetRankingListRequest();\n        }\n    },\n});\n"]}