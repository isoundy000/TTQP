{"version":3,"sources":["../../../../../../assets/Script/jajaleScript/PYT/assets/Script/jajaleScript/PYT/jajalePYTScript.js"],"names":["cc","Class","extends","Component","properties","IDL","Label","currentNumL","timeL","IDEdit","EditBox","createBox","Node","delRoomBox","roomPswBox","listContentView","listItem","Prefab","userRoomId","myRoominterval","editText","onLoad","onfire","on","jajalePYTRoomListMessage","bind","enterTheRoomMessage","onClosePYTHandle","console","log","node","active","onPYTHandle","event","customData","params","scn","socket","send","getComponent","configurea","onTextChanged","text","data","clearInterval","self","tmpRemainTime","string","removeAllChildren","roomList","index","length","roleId","ttqp_global","currentUserInfo","roomId","curOnline","remainTime","item","instantiate","addChild","initPYTItem","idx","interval","setInterval","unixTool","d","parseInt","h","m","s"],"mappings":"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","file":"jajalePYTScript.js","sourceRoot":"../../../../../../assets/Script/jajaleScript/PYT","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // ID\n        IDL: cc.Label,\n        // 当前人数\n        currentNumL: cc.Label,\n        // 剩余时间\n        timeL: cc.Label,\n        // ID输入框\n        IDEdit: cc.EditBox,\n        // 创建房间层\n        createBox: cc.Node,\n        // 删除房间层\n        delRoomBox: cc.Node,\n        // 房间密码层\n        roomPswBox: cc.Node,\n\n        // \n        listContentView: cc.Node,\n        // \n        listItem: cc.Prefab,\n\n        userRoomId: null,\n        myRoominterval: null,\n        editText: null,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        // 朋友厅房间列表\n        onfire.on(\"jajalePYTRoomListMessage\",this.jajalePYTRoomListMessage.bind(this));\n        // 进入房间\n        onfire.on(\"enterTheRoomMessage\",this.enterTheRoomMessage.bind(this));\n    },\n\n    /**\n     * 关闭朋友厅窗口\n     */\n    onClosePYTHandle: function() {\n        console.log('close');\n        this.node.active = false;\n    },\n\n    /**\n     * 事件操作\n     */\n    onPYTHandle: function(event, customData) {\n        console.log(123,customData);\n        switch (customData) {\n            case '删除房间':\n\n                if (this.userRoomId && this.userRoomId != 0) {\n                    this.delRoomBox.active = true;\n                }\n                \n                break;\n            case '进入房间':\n                \n                if (this.userRoomId && this.userRoomId != 0) {\n                    let params = {\n                        /**\n                         * roomId:(int) //房间号, 0：百家场；其它：朋友场的房间号ID\n                         * roomPwd:(string) //加锁密码；百家场则忽略\n                         * enterType:(int)//0百家厅，(朋友厅里用到) 1进入房间，2快速进入或者列表进入\n                         */\n                        \"roomId\": this.userRoomId,\n                        \"roomPwd\": '',\n                        \"enterType\": 1,\n                    };\n                    cc.scn.socket.send(112204, params);\n                    \n                }\n                \n                break;\n            case '快速加入':\n\n                if (this.editText) {\n                    this.roomPswBox.active = true;\n                    this.roomPswBox.getComponent('jajaleRoomPswScript').configurea(this.editText);\n                }\n                \n                break;\n            case '创建房间':\n                this.createBox.active = true;\n                break;\n            default:\n                break;\n        }\n    },\n    /**\n     * 输入房间ID内容 监听\n     */\n    onTextChanged: function(text, event, customData) {\n        this.editText = text;        \n    },\n    /**\n     * 进入房间接口回调\n     */\n    enterTheRoomMessage: function(data) {\n        this.node.active = false;\n        clearInterval(this.myRoominterval);\n    },\n    // 朋友厅房间列表\n    jajalePYTRoomListMessage: function(data) {\n\n        var self = this;\n\n        var tmpRemainTime = 0;\n        this.userRoomId = 0;\n        this.IDL.string = '- -';\n        this.currentNumL.string = '- -';\n        this.timeL.string = '- -';\n        clearInterval(this.myRoominterval);\n        this.listContentView.removeAllChildren();\n\n        var roomList = data.roomList;\n        \n        for (let index = 0; index < roomList.length; index++) {\n            if (roomList[index].roleId === ttqp_global.currentUserInfo.roleId) {\n                this.userRoomId = roomList[index].roomId;\n                this.IDL.string = roomList[index].roomId;\n                this.currentNumL.string = roomList[index].curOnline;\n                tmpRemainTime = data.remainTime;\n                \n            }else {\n                var item = cc.instantiate(this.listItem);\n                this.listContentView.addChild(item);\n                item.getComponent('jajalePYTItemScript').initPYTItem(roomList[index], function(idx) {\n                    \n                    self.roomPswBox.active = true;\n                    self.roomPswBox.getComponent('jajaleRoomPswScript').configurea(idx);\n                });\n            }\n            \n            \n        }\n\n        var interval = setInterval(function() {\n            if (tmpRemainTime != 0) {\n                self.timeL.string = self.unixTool(tmpRemainTime);\n                tmpRemainTime--;\n             \n                if(tmpRemainTime < 1) {\n                    clearInterval(interval);\n                }\n            }\n            \n        }, 1000);\n        this.myRoominterval = interval;\n    },\n\n\n    unixTool: function(remainTime) {\n        var d = parseInt(remainTime/86400);\n        var h = parseInt(remainTime%86400/3600);\n        var m = parseInt(remainTime%86400%3600/60);\n        var s = parseInt(remainTime%86400%3600%60);\n        return d + '天' + h + '小时' + m + '分' + s + '秒';\n    },\n});\n"]}