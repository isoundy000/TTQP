{"version":3,"sources":["../../../../../assets/Script/mallScript/assets/Script/mallScript/mallScript.js"],"names":["mallData","require","socket","cc","Class","extends","Component","properties","mall_gold_text","Label","mall_diamond_text","mall_back_btn","Button","mall_diamond_btn","mall_gold_btn","mall_prop_btn","mall_scrollview","ScrollView","mall_scroll_content","Node","mall_scroll_item","Prefab","mall_alert_box","mall_diamondLack_box","mall_sure_btn","mall_cancel_btn","mall_alert_text","mall_payWebView","onDiamondGoldAndPropAction","event","customData","setContentList","mallItemData","diamond","getComponent","setBtnStatus","gold","prop","onBackAction","console","log","node","_parent","active","onSureAndCancelAction","buyItemObj","hType","price","parseInt","string","parm","id","scn","send","onLoad","configMallData","self","s","director","getVisibleSize","width","paddingL","surplus","layout","Layout","paddingLeft","paddingRight","onItemLayerAction","onfire","on","mallBuyAtMessage","bind","updateGoldAtMessage","updateDiamondAtMessage","idx","length","dic","push","ttqp_global","currentUserInfo","lists","tag","removeAllChildren","scrollToTop","index","item","instantiate","addChild","dict","init","name","nd","stopPropagation","obj","getUserData","setAlertText","anim","Animation","play","total","detail","url","WebView","String","toString"],"mappings":"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","file":"mallScript.js","sourceRoot":"../../../../../assets/Script/mallScript","sourcesContent":["\nvar mallData = require(\"mall-data\");\nvar socket = require(\"websocketScript\");\n// var ws = new WebSocket(\"ws://192.168.3.22:8072\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        \n        // 金币\n        mall_gold_text: cc.Label,\n        // 钻石\n        mall_diamond_text: cc.Label,\n        // 返回\n        mall_back_btn: cc.Button,\n        // 钻石按钮\n        mall_diamond_btn: cc.Button,\n        // 金币按钮\n        mall_gold_btn: cc.Button,\n        // 道具按钮\n        mall_prop_btn: cc.Button,\n        // 滑动视图\n        mall_scrollview: cc.ScrollView,\n        // 滑动 content\n        mall_scroll_content: cc.Node,\n        // item\n        mall_scroll_item: cc.Prefab,\n        // 弹出 购买层\n        mall_alert_box: cc.Node,\n        // 弹出 钻石不足层\n        mall_diamondLack_box: cc.Node,\n        // 确认按钮\n        mall_sure_btn: cc.Button,\n        // 取消按钮\n        mall_cancel_btn: cc.Button,\n        // 弹框文字\n        mall_alert_text: cc.Label,\n        // 支付web\n        mall_payWebView: cc.Node,\n    },\n\n    // 钻石 1001、金币 1002、道具 1003  按钮事件\n    onDiamondGoldAndPropAction: function(event, customData) {\n\n        // 钻石商城\n        if (customData == \"1001\") { \n            this.setContentList(this.mallItemData.diamond, \"1001\");\n            this.mall_diamond_btn.getComponent('mallClassBtnScript').setBtnStatus(true,1);\n            this.mall_gold_btn.getComponent('mallClassBtnScript').setBtnStatus(false,2);\n            this.mall_prop_btn.getComponent('mallClassBtnScript').setBtnStatus(false,3);\n        }\n        // 金币商城\n        else if (customData == \"1002\") {\n            this.setContentList(this.mallItemData.gold, \"1002\");\n            this.mall_diamond_btn.getComponent('mallClassBtnScript').setBtnStatus(false,1);\n            this.mall_gold_btn.getComponent('mallClassBtnScript').setBtnStatus(true,2);\n            this.mall_prop_btn.getComponent('mallClassBtnScript').setBtnStatus(false,3);\n        }\n        // 道具商城\n        else if (customData == \"1003\") {\n            this.setContentList(this.mallItemData.prop, \"1003\");\n            this.mall_diamond_btn.getComponent('mallClassBtnScript').setBtnStatus(false,1);\n            this.mall_gold_btn.getComponent('mallClassBtnScript').setBtnStatus(false,2);\n            this.mall_prop_btn.getComponent('mallClassBtnScript').setBtnStatus(true,3);\n        }\n\n    },\n\n    onBackAction: function() {\n        console.log(\"back\",this.node._parent);\n        // cc.director.loadScene(\"Home\");\n        this.node._parent.active = false;\n    },\n    // 弹框 按钮事件\n    onSureAndCancelAction: function(event, customData) {\n\n        this.mall_alert_box.active = false;\n        if (customData == \"sure\") {\n            console.log(this.buyItemObj);\n            if (this.buyItemObj.hType != 'diamond') {\n                // 需要做钻石比较 购买消耗的钻石不能大于用户拥有的钻石\n                if (this.buyItemObj.price > parseInt(this.mall_diamond_text.string)) {\n                    \n                    this.mall_diamondLack_box.active = true;\n                    return;\n                }\n            }\n            var parm = {'id': this.buyItemObj.id,'num': 1};\n            cc.scn.socket.send(10666,parm);\n        }else if (customData == \"lack\") {\n            this.mall_diamondLack_box.active = false;\n            this.setContentList(this.mallItemData.diamond, \"1001\");\n            this.mall_diamond_btn.getComponent('mallClassBtnScript').setBtnStatus(true,1);\n            this.mall_gold_btn.getComponent('mallClassBtnScript').setBtnStatus(false,2);\n            this.mall_prop_btn.getComponent('mallClassBtnScript').setBtnStatus(false,3);\n        }else {\n            return;\n        }\n        \n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n\n    onLoad () {\n\n        \n\n        // 本地数据\n        this.configMallData();\n                \n        // 默认 钻石商城\n        this.setContentList(this.mallItemData.diamond, \"1001\");  \n\n        var self = this;\n        // 定义全局属性\n        // cc.scn = {};\n        // cc.scn.socket = socket.connect();\n\n\n        // 购买对象\n        this.buyItemObj = null;\n\n\n        // 动态控制 item padding  1500 为设计分辨率宽\n        var s = cc.director.getVisibleSize();\n        if (s.width > 1500) {\n            var paddingL = 0;\n            var surplus = s.width - 565 - 935;\n            if (surplus > 325) {\n                paddingL = (surplus - 325)/2;\n            }else {\n                paddingL = surplus / 2;\n            }   \n            var layout =  this.mall_scroll_content.getComponent(cc.Layout);\n            layout.paddingLeft = paddingL;\n            layout.paddingRight = paddingL;\n        }\n\n        // 事件监听\n        this.onItemLayerAction(\"onBuyAction\",this.mall_alert_box);\n\n        onfire.on(\"mallBuyAtMessage\",this.mallBuyAtMessage.bind(this));\n        onfire.on(\"updateGoldAtMessage\",this.updateGoldAtMessage.bind(this));\n        onfire.on(\"updateDiamondAtMessage\",this.updateDiamondAtMessage.bind(this));\n\n    },\n    // 数据\n    configMallData: function() {\n        \n        this.mallItemData = {};\n        this.mallItemData.diamond = [];\n        this.mallItemData.gold = [];\n        this.mallItemData.prop = [];\n        for (let idx = 0; idx < mallData.length; idx++) {\n            var dic = mallData[idx];\n            if (dic[\"hType\"] == \"diamond\") {\n                this.mallItemData.diamond.push(dic);\n            } else if (dic[\"hType\"] == \"gold\") {\n                this.mallItemData.gold.push(dic);\n            } else if (dic[\"hType\"] == \"prop\") {\n                this.mallItemData.prop.push(dic);\n            }\n        }\n\n        // 金币\n        this.mall_gold_text.string = ttqp_global.currentUserInfo.gold;\n        // 钻石\n        this.mall_diamond_text.string = ttqp_global.currentUserInfo.diamond;\n    },\n     // 根据状态 传递不同数据 创建item\n     setContentList: function(lists, tag) {\n\n        this.mall_scroll_content.removeAllChildren();\n        this.mall_scrollview.scrollToTop(0.01);       \n\n        for (let index = 0; index < lists.length; index++) {\n            var item = cc.instantiate(this.mall_scroll_item);\n            this.mall_scroll_content.addChild(item);\n            var dict = lists[index];\n            item.getComponent('goldItemScript').init(dict, tag);\n        }\n    },\n\n    // 监听购买事件\n    onItemLayerAction: function(name, nd) {\n\n        // 监听 name 事件\n        this.node.on(name, function(event) {\n            // 中断冒泡\n            event.stopPropagation();\n            // 获取用户数据\n            var obj = event.getUserData()[0];\n\n            this.setAlertText(obj);\n\n            this.buyItemObj = obj;\n            // 显示层\n            nd.active = true;\n   \n            var anim = nd.getComponent(cc.Animation);\n            anim.play();\n        }, this);\n\n        // 监听遮罩层 touch 事件 变向禁止触摸吞噬！！！！！\n        // 用 BlockInputEvents 组件替换\n        // nd.on(cc.Node.EventType.TOUCH_END, function(event) {}, this);\n    } ,\n    // 设置提示文\n    setAlertText: function(obj) {\n        switch (obj.tag) {\n            case '1001':\n                this.mall_alert_text.string = \"确定消耗\" + obj.price + \"元购买\" + obj.total;\n                break;\n            case '1002':\n                this.mall_alert_text.string = \"确定消耗\" + obj.price + \"钻石购买\" + obj.detail;\n                break;\n            case '1003':\n                this.mall_alert_text.string = \"确定消耗\" + obj.price + \"钻石购买\" + obj.detail + \"表情\";\n                break;\n        \n            default:\n                break;\n        }\n    },\n    // websocket message 监听事件\n    mallBuyAtMessage: function(obj) {\n        console.log('购买成功');\n        if (this.buyItemObj.hType == 'diamond') {\n            console.log('购买钻石'+obj.url);\n            this.mall_payWebView.active = true;\n            this.mall_payWebView.getComponent(cc.WebView).url = obj.url;\n        }\n\n    },\n    updateGoldAtMessage: function(obj) { \n        this.mall_gold_text.string = String(obj.gold);\n        ttqp_global.currentUserInfo.diamond = obj.gold.toString();\n    },\n    updateDiamondAtMessage: function(obj) {\n        this.mall_diamond_text.string = String(obj.diamond);\n        ttqp_global.currentUserInfo.gold = obj.diamond.toString();\n    }\n    \n});\n"]}