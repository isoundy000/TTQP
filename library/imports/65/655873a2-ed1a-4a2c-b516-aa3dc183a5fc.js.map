{"version":3,"sources":["../../../../../assets/Script/common/assets/Script/common/cardMove.js"],"names":["cc","Class","extends","Component","properties","cardMain","default","type","Node","cardMask","cardFragment","cardBack","backMask","rotate","open","look","bg","_touchStartX","_touchStartY","_touchMoveX","_touchMoveY","_currentMoveX","_currentMoveY","_cardOldHeight","_cardOldWidth","_thresholdUp","_thresholdDown","_thresholdLift","_thresholdRight","_sensitiveThr","_direction","_fragmentChildren","_isRotate","_openCardOverHook","_moveStartHook","_rotateCardHook","_currentShowCard","onLoad","children","height","width","on","EventType","TOUCH_START","cardMoveStart","TOUCH_MOVE","cardMoving","TOUCH_CANCEL","cardMoveCancel","TOUCH_END","cardMoveEnd","zIndex","setRotate","openCrad","lookCard","notLookCard","evnet","getLocationY","getLocationX","setShowCardLocation","isRotate","moveDirection","anchorY","anchorX","y","x","event","userMoveOver","active","rotation","scaleX","scaleY","setMoveStartHook","moveStartHook","setOpenCardOverHook","openCardEndHook","setRotateCardHook","rotateCardHook","setSensitiveThr","sensitive","initCard","showCardLocation","onDestroy","off","moveStart"],"mappings":"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","file":"cardMove.js","sourceRoot":"../../../../../assets/Script/common","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // main:{\r\n        //     default: null,        \r\n        //     type: cc.Node,\r\n        // },\r\n        cardMain:{\r\n            default: null,        \r\n            type: cc.Node,\r\n        },\r\n        cardMask: {\r\n            default: null,        \r\n            type: cc.Node,   \r\n        },\r\n        cardFragment:{\r\n            default: null,        \r\n            type: cc.Node, \r\n        },\r\n        cardBack:{\r\n            default: null,        \r\n            type: cc.Node, \r\n        },\r\n        backMask:{\r\n            default: null,        \r\n            type: cc.Node,\r\n        },\r\n\r\n\r\n        rotate:{\r\n            default: null,        \r\n            type: cc.Node,\r\n        },\r\n        open:{\r\n            default: null,        \r\n            type: cc.Node,\r\n        },\r\n\r\n        look:{\r\n            default: null,        \r\n            type: cc.Node,\r\n        },\r\n        bg:{\r\n            default: null,        \r\n            type: cc.Node,\r\n        },\r\n\r\n        _touchStartX: 0, //手指刚touch屏幕时的X坐标\r\n        _touchStartY: 0, //手指刚touch屏幕时的Y坐标\r\n        _touchMoveX: 0, //保存手指在屏幕上移动时的X坐标\r\n        _touchMoveY: 0, //保存手指在屏幕上移动时的Y坐标\r\n        _currentMoveX: 0, //当前手指在屏幕上移动时的X坐标\r\n        _currentMoveY: 0, //当前手指在屏幕上移动时的Y坐标\r\n        _cardOldHeight: 0, //card的原始高度\r\n        _cardOldWidth: 0, //card的原始宽度\r\n        _thresholdUp: 0, //card上滑的高度阀值。\r\n        _thresholdDown: 0, //card上滑的高度阀值。\r\n        _thresholdLift: 0, //card左滑的宽度阀值。\r\n        _thresholdRight: 0, //card右滑的宽度阀值。\r\n        _sensitiveThr: 10, //灵敏度的阀值,默认为10\r\n        _direction: 0, //card滑动的方向，0表示不滑动，1表示上滑动或右滑，-1表示下滑或左滑,2表示右滑，-2表示左滑。\r\n        _fragmentChildren: [], //fragment节点的所有子节点\r\n        _isRotate: false, //是否旋转\r\n        _openCardOverHook: null,//当牌完全被显示的时候回调，这是一个钩子钩子。\r\n        _moveStartHook: null, //当touchStart时候后回调，这是一个钩子钩子。\r\n        _rotateCardHook: null, //当点击旋转按钮时候后回调，这是一个钩子钩子。\r\n        _currentShowCard: null,//当前显示的牌\r\n    },\r\n\r\n    onLoad () {\r\n        this._fragmentChildren = this.cardFragment.children;\r\n        // this._currentShowCard = this._fragmentChildren[49].active = true;\r\n\r\n        this._cardOldHeight = this.backMask.height;\r\n        this._cardOldWidth = this.backMask.width;\r\n        this._thresholdUp = this._cardOldHeight*0.7;\r\n        this._thresholdDown = this._cardOldHeight*0.7;\r\n        this._thresholdLift = this._cardOldWidth*0.73;\r\n        this._thresholdRight = this._cardOldWidth*0.73;\r\n        this.backMask.on(cc.Node.EventType.TOUCH_START,this.cardMoveStart,this);\r\n        this.backMask.on(cc.Node.EventType.TOUCH_MOVE,this.cardMoving,this);\r\n        this.backMask.on(cc.Node.EventType.TOUCH_CANCEL,this.cardMoveCancel,this);\r\n        this.backMask.on(cc.Node.EventType.TOUCH_END,this.cardMoveEnd,this);\r\n        this.cardFragment.zIndex = 1;\r\n        this.backMask.zIndex =2;\r\n\r\n        this.rotate.on(cc.Node.EventType.TOUCH_START,this.setRotate,this);\r\n        this.open.on(cc.Node.EventType.TOUCH_START,this.openCrad,this);\r\n        this.look.on(cc.Node.EventType.TOUCH_START,this.lookCard,this)\r\n        this.look.on(cc.Node.EventType.TOUCH_END,this.notLookCard,this)\r\n    },\r\n    /**\r\n     * touch开始时候回调\r\n     */\r\n    cardMoveStart:function(evnet){\r\n        if(this._currentShowCard ==null){\r\n             throw '请初始化要显示的牌。请先调用 initCard 方法！';\r\n        }\r\n        \r\n        if(this._moveStartHook!=null && this._currentShowCard !=null){\r\n            this._moveStartHook(this._currentShowCard);\r\n        }\r\n\r\n        if(!this._isRotate){\r\n            //因为不旋转的时候上下左右都可以滑动\r\n            this._touchStartY = evnet.getLocationY();\r\n            this._touchMoveY = this._touchStartY;\r\n            this._touchStartX = evnet.getLocationX();\r\n            this._touchMoveX = this._touchStartX;\r\n        }else{\r\n            //旋转了\r\n            this._touchStartX = evnet.getLocationX();\r\n            this._touchMoveX = this._touchStartX;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 设置card的初始化位置\r\n     */\r\n    setShowCardLocation: function(isRotate, moveDirection){\r\n        if(moveDirection == 0){\r\n            //回复到原始状态\r\n            this.cardMask.anchorY = 0.5;\r\n            this.cardMask.anchorX = 0.5;\r\n            this.cardMask.y = 0;\r\n            this.cardMask.x = 0;\r\n            this.backMask.anchorY = 0.5;\r\n            this.backMask.anchorX = 0.5;\r\n            this.cardBack.y = 0;\r\n            this.cardBack.x = 0;\r\n            this.cardFragment.y = 0;\r\n            this.cardFragment.x = 0;\r\n            this.cardFragment.zIndex = 1;\r\n            this.backMask.zIndex =2;\r\n            this.cardMask.width = this._cardOldWidth;\r\n            this.cardMask.height = this._cardOldHeight;\r\n            this.backMask.width = this._cardOldWidth;\r\n            this.backMask.height = this._cardOldHeight;\r\n            return;\r\n        }\r\n        if(!isRotate){\r\n            //不旋转\r\n            if(moveDirection ==1){\r\n                //上滑\r\n                this.cardMask.anchorY = 1;\r\n                this.cardMask.y = 305;\r\n                this.backMask.anchorY = 1;\r\n                this.cardBack.y = -305;\r\n                this.cardFragment.y = -915;\r\n                this.cardFragment.zIndex = 2;\r\n                this.backMask.zIndex =1;\r\n                return;\r\n            }\r\n            if(moveDirection ==-1){\r\n                //下滑\r\n                this.backMask.y = 0;\r\n                return;\r\n            }\r\n            if(moveDirection ==2){\r\n                //右滑\r\n                this.cardMask.anchorX = 1;\r\n                this.cardMask.x = 220;\r\n                this.backMask.anchorX = 1;\r\n                this.cardBack.x = -220;\r\n                this.cardFragment.x = -660;\r\n                this.cardFragment.zIndex = 2;\r\n                this.backMask.zIndex =1;\r\n                return;\r\n            }\r\n            if(moveDirection ==-2){\r\n                //左滑\r\n                this.cardMask.anchorX = 0;\r\n                this.cardMask.x = -220;\r\n                this.backMask.anchorX = 0;\r\n                this.cardBack.x = 220;\r\n                this.cardFragment.x = 660;\r\n                this.cardFragment.zIndex = 2;\r\n                this.backMask.zIndex =1;\r\n                return;\r\n            }\r\n\r\n        }else{\r\n            //旋转的时候\r\n            if(moveDirection == 3){\r\n                //旋转后右滑\r\n                this.backMask.y = 0;\r\n                return;\r\n            }\r\n\r\n            if(moveDirection == -3){\r\n                //旋转后左滑\r\n                this.cardMask.anchorY = 1;\r\n                this.cardMask.y = 305;\r\n                this.backMask.anchorY = 1;\r\n                this.cardBack.y = -305;\r\n                this.cardFragment.y = -915;\r\n                this.cardFragment.zIndex = 2;\r\n                this.backMask.zIndex =1;\r\n                return;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * touch进行中回调\r\n     */\r\n    cardMoving:function(event){\r\n        //确定滑动的方向\r\n        if(this._direction == 0){\r\n            if(!this._isRotate){\r\n                //不旋转的时候\r\n                if(event.getLocationY()-this._touchStartY>this._sensitiveThr){\r\n                    //上滑\r\n                    this._direction = 1;\r\n                }else if(event.getLocationY()-this._touchStartY<-this._sensitiveThr){\r\n                    //下滑\r\n                    this._direction = -1; \r\n                }else if(event.getLocationX()-this._touchStartX>this._sensitiveThr){\r\n                    //右滑\r\n                    this._direction = 2;\r\n                }else if(event.getLocationX()-this._touchStartX<-this._sensitiveThr){\r\n                    //左滑\r\n                    this._direction = -2;\r\n                }\r\n            }else{\r\n                //旋转了\r\n                if(event.getLocationX()-this._touchStartX>this._sensitiveThr){\r\n                    //右滑\r\n                    this._direction = 3;\r\n                }else if(event.getLocationX()-this._touchStartX<-this._sensitiveThr){\r\n                    //左滑\r\n                    this._direction = -3; \r\n                }\r\n            }\r\n            //初始化方向\r\n            this.setShowCardLocation(this._isRotate,this._direction);\r\n        }\r\n\r\n        if(!this._isRotate){\r\n            //不旋转的时候处理滑动牌\r\n            if(this._direction == 1 && event.getLocationY()-this._touchStartY < this._thresholdUp && event.getLocationY()-this._touchStartY>0){\r\n                this._currentMoveY = event.getLocationY();\r\n                this.backMask.height -= this._currentMoveY-this._touchMoveY;\r\n                this.cardMask.height -= this._currentMoveY-this._touchMoveY;\r\n                this.cardFragment.y += (this._currentMoveY-this._touchMoveY)*2;\r\n                this._touchMoveY = this._currentMoveY;\r\n            }else if(this._direction == -1 && this._touchStartY-event.getLocationY() < this._thresholdDown && event.getLocationY()-this._touchStartY<0){\r\n                this._currentMoveY = event.getLocationY();\r\n                this.backMask.y +=this._currentMoveY-this._touchMoveY;\r\n                this._touchMoveY = this._currentMoveY;\r\n            }else if(this._direction == 2 && event.getLocationX()-this._touchStartX < this._thresholdRight && event.getLocationX()-this._touchStartX>0){\r\n                this._currentMoveX = event.getLocationX();\r\n                if(this._currentMoveX - this._touchStartX>this._cardOldWidth*0.5){\r\n                    //改变锚点\r\n                    this.cardMask.anchorX = 0.5;\r\n                    this.cardMask.width =this._cardOldWidth;\r\n                }\r\n                this.backMask.width -= this._currentMoveX-this._touchMoveX;\r\n                this.cardMask.width -= this._currentMoveX-this._touchMoveX;\r\n                this.cardFragment.x += (this._currentMoveX-this._touchMoveX)*2;\r\n                this._touchMoveX = this._currentMoveX;\r\n            }else if (this._direction == -2 && event.getLocationX()-this._touchStartX > -this._thresholdLift && event.getLocationX()-this._touchStartX<0){\r\n                this._currentMoveX = event.getLocationX();\r\n                if(this._currentMoveX - this._touchStartX<-this._cardOldWidth*0.5){ \r\n                    //改变锚点\r\n                    this.cardMask.anchorX = 0.5;\r\n                    this.cardMask.width =this._cardOldWidth;\r\n                }\r\n                this.backMask.width += this._currentMoveX-this._touchMoveX;\r\n                this.cardMask.width += this._currentMoveX-this._touchMoveX;\r\n                this.cardFragment.x += (this._currentMoveX-this._touchMoveX)*2;\r\n                this._touchMoveX = this._currentMoveX;\r\n            }\r\n        }else{\r\n            //旋转以后的滑动处理\r\n            if(this._direction == 3 && event.getLocationX()-this._touchStartX < this._thresholdUp && event.getLocationX()-this._touchStartX>0){\r\n                this._currentMoveX = event.getLocationX();\r\n                this.backMask.y -=this._currentMoveX-this._touchMoveX;\r\n                this._touchMoveX = this._currentMoveX;\r\n            }else if(this._direction == -3 && this._touchStartX-event.getLocationX() < this._thresholdDown && event.getLocationX()-this._touchStartX<0){\r\n                this._currentMoveX = event.getLocationX();\r\n                if(this._currentMoveX - this._touchStartX<-this._cardOldHeight*0.5){ \r\n                    //改变锚点\r\n                    this.cardMask.anchorY = 0.5;\r\n                    this.cardMask.height =this._cardOldHeight;\r\n                }\r\n                this.backMask.height += this._currentMoveX-this._touchMoveX;\r\n                this.cardMask.height += this._currentMoveX-this._touchMoveX;\r\n                this.cardFragment.y -= (this._currentMoveX-this._touchMoveX)*2;\r\n                this._touchMoveX = this._currentMoveX;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * touch结束时回调(目标节点区域内离开)\r\n     */\r\n    cardMoveEnd:function(event){\r\n        this.userMoveOver(event);\r\n    },\r\n\r\n    /**\r\n     * touch结束时回调(目标节点区域外离开)\r\n     */\r\n    cardMoveCancel:function(event){\r\n        this.userMoveOver(event);\r\n        \r\n    },\r\n    /**\r\n     * touch结束的处理\r\n     */\r\n    userMoveOver:function(event){\r\n        //用户滑松开手指的处理。\r\n        if(!this._isRotate){\r\n            //没有旋转的处理\r\n            if(this._direction == 1){\r\n                //上滑结束的处理\r\n                if(event.getLocationY()-this._touchStartY>this._thresholdUp && event.getLocationY()-this._touchStartY>0){\r\n                    this.backMask.active = false;\r\n                    this.setShowCardLocation(this._isRotate,0);\r\n                    //这里需要添加结束回调\r\n                    if(this._openCardOverHook!=null && this._currentShowCard!=null){\r\n                        this._openCardOverHook(this._currentShowCard)\r\n                    }\r\n                    \r\n                }else{\r\n                    this.backMask.height = this._cardOldHeight;\r\n                    this.cardMask.height = this._cardOldHeight;\r\n                    this.setShowCardLocation(this._isRotate,this._direction);\r\n                }\r\n\r\n            }else if(this._direction == -1){\r\n                //下滑结束的处理\r\n                if(event.getLocationY()-this._touchStartY<-this._thresholdDown && event.getLocationY()-this._touchStartY<0){\r\n                    this.backMask.active = false;\r\n                    this.setShowCardLocation(this._isRotate,0);\r\n                    //这里需要添加结束回调\r\n                    if(this._openCardOverHook!=null && this._currentShowCard!=null){\r\n                        this._openCardOverHook(this._currentShowCard)\r\n                    }\r\n                }else{\r\n                    this.setShowCardLocation(this._isRotate,this._direction);\r\n                }\r\n            }else if(this._direction == 2){\r\n                //右滑结束处理\r\n                if(event.getLocationX()-this._touchStartX>this._thresholdRight && event.getLocationX()-this._touchStartX>0){\r\n                    this.backMask.active = false;\r\n                    this.setShowCardLocation(this._isRotate,0);\r\n                    //这里需要添加结束回调\r\n                    if(this._openCardOverHook!=null && this._currentShowCard!=null){\r\n                        this._openCardOverHook(this._currentShowCard)\r\n                    }\r\n                }else{\r\n                    this.backMask.width = this._cardOldWidth;\r\n                    this.cardMask.width = this._cardOldWidth;\r\n                    this.setShowCardLocation(this._isRotate,this._direction);\r\n                }\r\n\r\n            }else if(this._direction == -2){\r\n                //左滑结束处理\r\n                if(event.getLocationX()-this._touchStartX<-this._thresholdRight && event.getLocationX()-this._touchStartX<0){\r\n                    this.backMask.active = false;\r\n                    this.setShowCardLocation(this._isRotate,0);\r\n                    //这里需要添加结束回调\r\n                    if(this._openCardOverHook!=null && this._currentShowCard!=null){\r\n                        this._openCardOverHook(this._currentShowCard)\r\n                    }\r\n                }else{\r\n                    this.backMask.width = this._cardOldWidth;\r\n                    this.cardMask.width = this._cardOldWidth;\r\n                    this.setShowCardLocation(this._isRotate,this._direction);\r\n                }\r\n                \r\n            }\r\n        }else{\r\n            //有旋转的处理\r\n            if(this._direction ==-3){\r\n                //左滑结束的处理\r\n                if(event.getLocationX()-this._touchStartX<-this._thresholdUp && event.getLocationX()-this._touchStartX<0){\r\n                    this.backMask.active = false;\r\n                    this.setShowCardLocation(this._isRotate,0);\r\n                    //这里需要添加结束回调\r\n                    if(this._openCardOverHook!=null && this._currentShowCard!=null){\r\n                        this._openCardOverHook(this._currentShowCard)\r\n                    }\r\n                    \r\n                }else{\r\n                    this.backMask.height = this._cardOldHeight;\r\n                    this.cardMask.height = this._cardOldHeight;\r\n                    this.setShowCardLocation(this._isRotate,this._direction);\r\n                }\r\n\r\n            }else if(this._direction == 3){\r\n                //右滑结束的处理\r\n                if(event.getLocationX()-this._touchStartX>this._thresholdDown && event.getLocationX()-this._touchStartX>0){\r\n                    this.backMask.active = false;\r\n                    this.setShowCardLocation(this._isRotate,0);\r\n                    //这里需要添加结束回调\r\n                    if(this._openCardOverHook!=null && this._currentShowCard!=null){\r\n                        this._openCardOverHook(this._currentShowCard)\r\n                    }\r\n                }else{\r\n                    this.setShowCardLocation(this._isRotate,this._direction);\r\n                }\r\n            }\r\n        }\r\n\r\n        this._direction = 0;//当用户离开的时候，把方向状态改为0\r\n    },\r\n\r\n\r\n\r\n\r\n    /**\r\n     * 设置旋转牌\r\n     */\r\n    setRotate:function(){\r\n        if(this._rotateCardHook !=null){\r\n            //点击旋转按钮回调\r\n            this._rotateCardHook(this._currentShowCard,this.cardMain,this._isRotate)\r\n        }else{\r\n            if(this._isRotate){\r\n                this.cardMain.rotation = 0;\r\n                this._isRotate = false;\r\n                this.cardMain.scaleX = 1.8;\r\n                this.cardMain.scaleY = 1.8;\r\n            }else{\r\n                this.cardMain.rotation = -90;\r\n                this._isRotate = true;\r\n                this.cardMain.scaleX = 2.4;\r\n                this.cardMain.scaleY = 2.4;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 直接开牌\r\n     */\r\n    openCrad:function(){\r\n        this.backMask.active = false;\r\n        if(this._openCardOverHook!=null && this._currentShowCard!=null){\r\n            this._openCardOverHook(this._currentShowCard);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 看已经发好的牌\r\n     */\r\n    lookCard:function(){\r\n        this.bg.active = false;\r\n        this.cardMain.active = false;\r\n    },\r\n    /**\r\n     * 回到搓牌界面\r\n     */\r\n    notLookCard:function(){\r\n        this.bg.active = true;\r\n        this.cardMain.active = true;\r\n    },\r\n    \r\n    /**\r\n     * 设置moveStartHook回调\r\n     */\r\n    setMoveStartHook:function(moveStartHook){\r\n        this._moveStartHook = moveStartHook;\r\n    },\r\n    /**\r\n     *设置开牌结束回调\r\n     */\r\n    setOpenCardOverHook: function(openCardEndHook){\r\n        this._openCardOverHook = openCardEndHook;\r\n    },\r\n    /**\r\n     * 设置点击旋转按钮的回调\r\n     */\r\n    setRotateCardHook:function(rotateCardHook){\r\n        this._rotateCardHook = rotateCardHook;\r\n    },\r\n\r\n    /**\r\n     * 设置灵敏度\r\n     */\r\n    setSensitiveThr:function(sensitive){\r\n        this._sensitiveThr = sensitive;\r\n    },\r\n\r\n    /**\r\n     * 这个方法很重要，初始化要显示的牌，信息，等等。\r\n     */\r\n    initCard:function(showCardLocation){\r\n        if(!this.backMask.active){\r\n            this.backMask.active = true;\r\n        }\r\n        this.cardMain.rotation = 0;\r\n        this.setShowCardLocation(false,0);\r\n        this._currentShowCard = this._fragmentChildren[showCardLocation];\r\n        this._currentShowCard.active = true;\r\n    },\r\n\r\n    onDestroy(){\r\n        //释放资源\r\n        this.backMask.off(cc.Node.EventType.TOUCH_START,this.moveStart,this);\r\n        this.backMask.off(cc.Node.EventType.TOUCH_MOVE,this.cardMoving,this);\r\n        this.backMask.off(cc.Node.EventType.TOUCH_CANCEL,this.cardMoveCancel,this);\r\n        this.backMask.off(cc.Node.EventType.TOUCH_END,this.cardMoveEnd,this);\r\n\r\n        this.rotate.off(cc.Node.EventType.TOUCH_START,this.setRotate,this);\r\n        this.open.off(cc.Node.EventType.TOUCH_START,this.openCrad,this);\r\n        this.look.off(cc.Node.EventType.TOUCH_START,this.lookCard,this);\r\n        this.look.off(cc.Node.EventType.TOUCH_END,this.notLookCard,this);\r\n\r\n        this._fragmentChildren = [];\r\n    }\r\n});\r\n"]}